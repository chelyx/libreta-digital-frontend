<div class="container">
  <mat-card class="qr-card">
    <mat-card-header>
      <mat-card-title>Validar Código</mat-card-title>
      <mat-card-subtitle>Escanea el código QR con tu cámara o ingresa el token manualmente</mat-card-subtitle>
    </mat-card-header>

    <mat-card-content>
      <button
        mat-fab
        [color]="scanning ? 'warn' : 'primary'"
        (click)="toggleCamera()"
        class="camera-button">
        <mat-icon>{{ scanning ? 'camera_alt' : 'photo_camera' }}</mat-icon>
      </button>

      <div *ngIf="scanning" class="camera-container">
        <video #video autoplay playsinline></video>
        <canvas #canvas style="display: none;"></canvas>
      </div>

      <div class="manual-input" [class.disabled]="scanning">
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Ingresar token manualmente</mat-label>
          <input
            matInput
            [(ngModel)]="token"
            [disabled]="scanning"
            placeholder="Ingrese el token">
        </mat-form-field>

        <button
          mat-raised-button
          color="primary"
          (click)="validateToken()"
          [disabled]="scanning"
          class="validate-button">
          Validar Token
        </button>
      </div>
    </mat-card-content>
  </mat-card>

  <mat-card *ngIf="validated" class="success-card">
    <mat-card-header>
      <mat-card-title>Token Validado</mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <p>El token ha sido validado correctamente.</p>
      <div *ngIf="studentData">
        <p><strong>Datos del estudiante:</strong></p>
        <pre>{{ studentData | json }}</pre>
      </div>
    </mat-card-content>
  </mat-card>
</div>
